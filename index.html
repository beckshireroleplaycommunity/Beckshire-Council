<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Royal Military Police - Command Portal</title>
  <style>
    body { font-family: Arial, sans-serif; background: #f4f4f8; margin: 0; padding: 0; }
    header { background: #8b0000; color: white; padding: 1rem; text-align: center; }
    nav { display: flex; justify-content: center; gap: 1rem; margin: 1rem 0; }
    nav button { background: white; border: 1px solid #ccc; padding: 0.5rem 1rem; cursor: pointer; border-radius: 6px; }
    main { max-width: 900px; margin: auto; background: white; padding: 1rem 2rem; border-radius: 10px; box-shadow: 0 0 5px rgba(0,0,0,0.1); }
    h2 { border-bottom: 2px solid #8b0000; padding-bottom: 0.3rem; color: #8b0000; }
    input, textarea { width: 100%; padding: 0.5rem; margin: 0.3rem 0; border-radius: 5px; border: 1px solid #ccc; }
    button.add { background: #8b0000; color: white; border: none; padding: 0.5rem 1rem; margin-top: 0.5rem; border-radius: 5px; }
    ul { list-style: none; padding: 0; }
    li { border: 1px solid #ddd; padding: 0.5rem; margin: 0.4rem 0; border-radius: 5px; }
    .hidden { display: none; }
    .controls button { margin-right: 0.3rem; }
  </style>
</head>
<body>

  <header>
    <h1>Royal Military Police - Command Portal</h1>
    <p>Manage command team, inspections, and practice inspections</p>
  </header>

  <nav>
    <button onclick="showView('team')">Command Team</button>
    <button onclick="showView('inspections')">Inspections</button>
    <button onclick="showView('practice')">Practice</button>
    <button onclick="exportData()">Export</button>
    <label style="background:white;border:1px solid #ccc;padding:0.5rem 1rem;border-radius:6px;cursor:pointer;">
      Import <input type="file" accept="application/json" onchange="importData(event)" style="display:none;">
    </label>
  </nav>

  <main>
    <!-- Command Team -->
    <section id="team" class="view">
      <h2>Command Team</h2>
      <input id="rank" placeholder="Rank" />
      <input id="name" placeholder="Name" />
      <input id="role" placeholder="Role" />
      <input id="contact" placeholder="Contact Info" />
      <button class="add" onclick="addMember()">Add Member</button>
      <ul id="teamList"></ul>
    </section>

    <!-- Inspections -->
    <section id="inspections" class="view hidden">
      <h2>Inspections</h2>
      <input id="inspectionTitle" placeholder="Inspection Title" />
      <input id="inspectionDate" type="date" />
      <textarea id="inspectionNotes" placeholder="Notes"></textarea>
      <button class="add" onclick="addInspection()">Add Inspection</button>
      <ul id="inspectionList"></ul>
    </section>

    <!-- Practice Inspections -->
    <section id="practice" class="view hidden">
      <h2>Practice Inspections</h2>
      <input id="practiceTitle" placeholder="Practice Title" />
      <textarea id="practiceChecklist" placeholder="Checklist (comma separated)"></textarea>
      <button class="add" onclick="addPractice()">Add Practice Template</button>
      <ul id="practiceList"></ul>
    </section>
  </main>

  <script>
    const STORAGE_KEY = "rmp_portal_data";
    let data = JSON.parse(localStorage.getItem(STORAGE_KEY) || '{"team":[],"inspections":[],"practice":[]}');

    function save() {
      localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
      render();
    }

    function showView(id) {
      document.querySelectorAll('.view').forEach(v => v.classList.add('hidden'));
      document.getElementById(id).classList.remove('hidden');
    }

    // ---- TEAM ----
    function addMember() {
      const rank = rankInput.value.trim(), name = nameInput.value.trim();
      if (!name) return;
      data.team.push({ id: Date.now(), rank, name, role: roleInput.value, contact: contactInput.value });
      rankInput.value = nameInput.value = roleInput.value = contactInput.value = "";
      save();
    }

    function deleteMember(id) {
      data.team = data.team.filter(m => m.id !== id);
      save();
    }

    // ---- INSPECTIONS ----
    function addInspection() {
      const title = inspectionTitle.value.trim();
      if (!title) return;
      data.inspections.push({ id: Date.now(), title, date: inspectionDate.value, notes: inspectionNotes.value, completed: false });
      inspectionTitle.value = inspectionNotes.value = ""; inspectionDate.value = "";
      save();
    }

    function toggleInspection(id) {
      const i = data.inspections.find(x => x.id === id);
      if (i) i.completed = !i.completed;
      save();
    }

    function deleteInspection(id) {
      data.inspections = data.inspections.filter(i => i.id !== id);
      save();
    }

    // ---- PRACTICE ----
    function addPractice() {
      const title = practiceTitle.value.trim();
      if (!title) return;
      const checklist = practiceChecklist.value.split(',').map(x => x.trim()).filter(Boolean);
      data.practice.push({ id: Date.now(), title, checklist });
      practiceTitle.value = practiceChecklist.value = "";
      save();
    }

    function deletePractice(id) {
      data.practice = data.practice.filter(p => p.id !== id);
      save();
    }

    // ---- EXPORT / IMPORT ----
    function exportData() {
      const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'rmp-data.json';
      a.click();
      URL.revokeObjectURL(url);
    }

    function importData(ev) {
      const file = ev.target.files[0];
      if (!file) return;
      const reader = new FileReader();
      reader.onload = () => {
        try {
          data = JSON.parse(reader.result);
          save();
        } catch {
          alert('Invalid JSON file');
        }
      };
      reader.readAsText(file);
    }

    // ---- RENDER ----
    function render() {
      const teamList = document.getElementById('teamList');
      teamList.innerHTML = data.team.map(m => `
        <li>
          <strong>${m.rank} ${m.name}</strong><br>
          <small>${m.role} ${m.contact ? 'â€¢ ' + m.contact : ''}</small><br>
          <button onclick="deleteMember(${m.id})">Delete</button>
        </li>
      `).join('');

      const inspectionList = document.getElementById('inspectionList');
      inspectionList.innerHTML = data.inspections.map(i => `
        <li>
          <strong>${i.title}</strong> (${i.date || 'No date'})<br>
          <small>${i.notes || ''}</small><br>
          <button onclick="toggleInspection(${i.id})">${i.completed ? 'Mark Pending' : 'Mark Done'}</button>
          <button onclick="deleteInspection(${i.id})">Delete</button>
        </li>
      `).join('');

      const practiceList = document.getElementById('practiceList');
      practiceList.innerHTML = data.practice.map(p => `
        <li>
          <strong>${p.title}</strong><br>
          <small>${p.checklist.join(', ')}</small><br>
          <button onclick="deletePractice(${p.id})">Delete</button>
        </li>
      `).join('');
    }

    const rankInput = document.getElementById('rank');
    const nameInput = document.getElementById('name');
    const roleInput = document.getElementById('role');
    const contactInput = document.getElementById('contact');
    render();
  </script>

</body>
</html>
